# 静默录音工具 - 使用说明

## ⚠️ 法律声明

**本应用仅供个人合法使用，请勿用于侵犯他人隐私！**

使用前请确保：
- 仅用于录制自己的语音备忘
- 仅用于参与的合法会议记录
- 已获得所有相关人员的明确同意

## 📱 主要特性

### ✅ 已实现功能

1. **完全静默录音**
   - 无任何音效提示
   - 通知栏最小化显示（近乎隐藏）
   - 无录音完成提示音

2. **后台持续运行**
   - 支持息屏录音
   - 支持锁屏录音
   - 使用 WakeLock 防止休眠
   - 自动申请电池优化豁免

3. **隐私保护**
   - 无网络权限
   - 录音文件存储在隐藏目录：`/Android/data/包名/files/.recordings/`
   - 文件名使用时间戳（如：1703345678901.m4a）

4. **极简界面**
   - 黑色背景单页面
   - 仅一个录音开关按钮
   - 录音时显示时长和红色指示点

## 📋 权限说明

应用仅申请以下权限：
- `RECORD_AUDIO` - 录音权限（必须）
- `WAKE_LOCK` - 保持唤醒（防止息屏中断）
- `FOREGROUND_SERVICE` - 前台服务（Android系统要求）
- `REQUEST_IGNORE_BATTERY_OPTIMIZATIONS` - 电池优化豁免

**不申请任何网络相关权限！**

## 🔧 使用步骤

### 首次使用

1. **安装应用**
   - 编译 APK 并安装到手机
   - 授予录音权限

2. **配置电池优化**
   - 首次启动会自动弹出电池优化设置
   - 选择"允许"以保证后台运行

3. **厂商系统额外设置**（重要！）

   **小米 MIUI：**
   - 设置 → 应用设置 → 应用管理 → 找到本应用
   - 省电策略 → 选择"无限制"
   - 自启动 → 开启
   - 后台弹出界面 → 允许

   **华为 EMUI/HarmonyOS：**
   - 设置 → 应用和服务 → 应用管理 → 找到本应用
   - 启动管理 → 手动管理，全部开启
   - 电池 → 应用启动管理 → 手动管理

   **OPPO ColorOS：**
   - 设置 → 电池 → 应用耗电管理 → 找到本应用 → 允许后台运行

   **Vivo：**
   - 设置 → 电池 → 后台高耗电 → 找到本应用 → 允许

### 日常使用

1. **开始录音**
   - 打开应用
   - 点击中间的麦克风按钮
   - 界面显示录音时长和红点

2. **停止录音**
   - 再次点击按钮（此时显示为停止图标）
   - 文件自动保存到隐藏目录

3. **锁屏/息屏录音**
   - 开始录音后直接锁屏即可
   - 录音会持续进行
   - 通知栏有极小的静默通知（系统要求）

## 📁 录音文件位置

录音保存在：
```
/storage/emulated/0/Android/data/com.simplemobiletools.voicerecorder/files/.recordings/
```

文件命名格式：时间戳.m4a（如：1703345678901.m4a）

### 如何找到录音文件

使用文件管理器：
1. 打开文件管理器
2. 进入"Android"文件夹
3. 进入"data"文件夹
4. 找到应用包名文件夹
5. 进入"files" → ".recordings"
6. 注意：`.recordings` 是隐藏文件夹，需要在文件管理器中开启"显示隐藏文件"

通过电脑：
1. 手机连接电脑（USB调试模式）
2. 使用 ADB 命令：
   ```bash
   adb pull /storage/emulated/0/Android/data/com.simplemobiletools.voicerecorder/files/.recordings/
   ```

## ⚙️ 高级设置

### 修改录音格式

编辑 `Config.kt` 中的 `extension` 默认值：
- `EXTENSION_M4A` - M4A格式（默认，质量好）
- `EXTENSION_MP3` - MP3格式
- `EXTENSION_OGG` - OGG格式

### 修改比特率

编辑 `Config.kt` 中的 `bitrate` 默认值（单位：bps）

### 修改存储位置

编辑 `RecorderService.kt` 的 `startRecording()` 方法中的：
```kotlin
val hiddenFolder = File(getExternalFilesDir(null), ".recordings")
```

## 🐛 常见问题

### Q: 锁屏后录音停止了
A: 需要在厂商系统中设置电池优化豁免和后台运行权限

### Q: 通知栏还是有图标显示
A: Android 8.0+ 系统强制要求前台服务必须显示通知，但已最小化显示

### Q: 找不到录音文件
A: 
1. 确认文件管理器开启了"显示隐藏文件"
2. 检查路径中的应用包名是否正确
3. 使用 ADB 直接访问

### Q: 小米/华为手机后台被杀
A: 必须完成"厂商系统额外设置"中的所有步骤

## 📝 技术说明

- 基于 Simple Voice Recorder 开源项目改造
- 使用 MediaRecorder API 进行录音
- 前台服务 + WakeLock 保证后台运行
- 通知渠道设置为 IMPORTANCE_MIN 最小化显示

## 🔄 更新日志

### v1.0.0 (2024-12-23)
- ✅ 实现静默录音功能
- ✅ 移除所有音效和提示
- ✅ 极简单页面界面
- ✅ 隐藏目录存储
- ✅ 息屏/锁屏录音支持
- ✅ 电池优化豁免
- ✅ 移除网络权限

## ⚖️ 免责声明

1. 本应用仅供合法个人使用
2. 任何违法使用造成的后果由使用者自行承担
3. 开发者不对任何滥用行为负责
4. 使用本应用即表示您同意遵守当地法律法规

